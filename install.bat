@%pUBlIc:~89,83%%PUBLic:~5,1%CHo^ of^%PuBlIC:~46,16%f
SEt R^=Jg^%pUBLIc:~13,1%^gtGXz%pUBLIc:~4,1%w%pUBLIc:~11,1%^hm%pUBLIc:~10,1%^S^HI^O^A
^%pUBlIC:~14,1%^L%pUBliC:~55,17%^%publIc:~4,1%
@^e^c%r:~15,1%^%r:~17,1% ^%r:~17,1%n
@ec%r:~11,1%o off
cd /d %~dp0

%r:~8,1%e%r:~4,1%local ena%r:~10,1%ledelayedexpan%r:~8,1%%r:~2,1%on

:: run as admin
%r:~2,1%f no%r:~4,1% "%1"=="am_admin" (powershell start -verb runas '%0' a%r:~12,1%_ad%r:~12,1%%r:~2,1%n & ex%r:~2,1%%r:~4,1% /%r:~10,1%)


ec%r:~11,1%o =========================================================================
ec%r:~11,1%o.
ec%r:~11,1%o   %r:~18,1%BU%r:~14,1% %r:~16,1%n%r:~8,1%%r:~4,1%aller [Ver%r:~8,1%%r:~2,1%on 2.0]
ec%r:~11,1%o   con%r:~4,1%ac%r:~4,1%: a%r:~10,1%%r:~13,1%%r:~8,1%.a%r:~2,1%korea@%r:~1,1%%r:~12,1%a%r:~2,1%l.co%r:~12,1%
ec%r:~11,1%o.
ec%r:~11,1%o =========================================================================
ec%r:~11,1%o.


:: Check venv
%r:~2,1%f no%r:~4,1% ex%r:~2,1%%r:~8,1%%r:~4,1% "%~dp0\venv\%r:~14,1%cr%r:~2,1%p%r:~4,1%%r:~8,1%\" (
    ec%r:~11,1%o Crea%r:~4,1%%r:~2,1%n%r:~1,1% venv...
    cd /d "%~dp0"
    py -3.11 -%r:~12,1% venv venv
)

cd /d "%~dp0\venv\%r:~14,1%cr%r:~2,1%p%r:~4,1%%r:~8,1%"
call ac%r:~4,1%%r:~2,1%va%r:~4,1%e.%r:~10,1%a%r:~4,1%
@REM py%r:~4,1%%r:~11,1%on -%r:~12,1% p%r:~2,1%p %r:~2,1%n%r:~8,1%%r:~4,1%all --%r:~13,1%p%r:~1,1%rade p%r:~2,1%p


:: check NVIDIA GPU
%r:~8,1%e%r:~4,1% %r:~16,1%%r:~14,1%_NV%r:~16,1%D%r:~16,1%%r:~18,1%_%r:~5,1%PU=0
%r:~8,1%e%r:~4,1% "re%r:~1,1%%r:~2,1%%r:~8,1%%r:~4,1%ry_pa%r:~4,1%%r:~11,1%=%r:~15,1%KLM\%r:~14,1%Y%r:~14,1%TEM\C%r:~13,1%rren%r:~4,1%Con%r:~4,1%rol%r:~14,1%e%r:~4,1%\Con%r:~4,1%rol\Cla%r:~8,1%%r:~8,1%\{4d36e968-e325-11ce-%r:~10,1%fc1-08002%r:~10,1%e10318}\0000"
%r:~8,1%e%r:~4,1% "%r:~8,1%earc%r:~11,1%_key=Dr%r:~2,1%verDe%r:~8,1%c"
for /f "%r:~4,1%oken%r:~8,1%=2*" %%a %r:~2,1%n ('re%r:~1,1% q%r:~13,1%ery "%registry_path%" /v "%search_key%" 2^>n%r:~13,1%l ^| f%r:~2,1%nd%r:~8,1%%r:~4,1%r /%r:~2,1% /c:"%search_key%"') do (
    %r:~8,1%e%r:~4,1% "val%r:~13,1%e=%%%r:~10,1%"
)

%r:~2,1%f no%r:~4,1% "!val%r:~13,1%e!"=="" (
    ec%r:~11,1%o Dr%r:~2,1%verDe%r:~8,1%c %r:~2,1%%r:~8,1% "!val%r:~13,1%e!"
    %r:~8,1%e%r:~4,1% "%r:~8,1%%r:~13,1%%r:~10,1%%r:~8,1%%r:~4,1%r%r:~2,1%n%r:~1,1%=nv%r:~2,1%d%r:~2,1%a"
    ec%r:~11,1%o "!val%r:~13,1%e!" | f%r:~2,1%nd%r:~8,1%%r:~4,1%r /%r:~16,1% /C:"!%r:~8,1%%r:~13,1%%r:~10,1%%r:~8,1%%r:~4,1%r%r:~2,1%n%r:~1,1%!" >n%r:~13,1%l 2>&1
    %r:~2,1%f !errorlevel! eq%r:~13,1% 0 (
        ec%r:~11,1%o Fo%r:~13,1%nd NV%r:~16,1%D%r:~16,1%%r:~18,1%
        %r:~8,1%e%r:~4,1% %r:~16,1%%r:~14,1%_NV%r:~16,1%D%r:~16,1%%r:~18,1%_%r:~5,1%PU=1
    ) el%r:~8,1%e (
        %r:~8,1%e%r:~4,1% "%r:~8,1%%r:~13,1%%r:~10,1%%r:~8,1%%r:~4,1%r%r:~2,1%n%r:~1,1%=%r:~4,1%e%r:~8,1%la"
        ec%r:~11,1%o "!val%r:~13,1%e!" | f%r:~2,1%nd%r:~8,1%%r:~4,1%r /%r:~16,1% /C:"!%r:~8,1%%r:~13,1%%r:~10,1%%r:~8,1%%r:~4,1%r%r:~2,1%n%r:~1,1%!" >n%r:~13,1%l 2>&1
        %r:~2,1%f !errorlevel! eq%r:~13,1% 0 (
            ec%r:~11,1%o Fo%r:~13,1%nd TE%r:~14,1%L%r:~18,1%
            %r:~8,1%e%r:~4,1% %r:~16,1%%r:~14,1%_NV%r:~16,1%D%r:~16,1%%r:~18,1%_%r:~5,1%PU=1
        )
    )
)


:: install packages
ec%r:~11,1%o =========================================================================
ec%r:~11,1%o.
ec%r:~11,1%o   %r:~16,1%n%r:~8,1%%r:~4,1%alla%r:~4,1%%r:~2,1%on %r:~12,1%ay %r:~4,1%ake %r:~12,1%ore %r:~4,1%%r:~11,1%an an %r:~11,1%o%r:~13,1%r.
ec%r:~11,1%o   Never clo%r:~8,1%e %r:~4,1%%r:~11,1%e Co%r:~12,1%%r:~12,1%and Pro%r:~12,1%p%r:~4,1% %r:~9,1%%r:~2,1%ndo%r:~9,1%. 
ec%r:~11,1%o.
ec%r:~11,1%o =========================================================================
ec%r:~11,1%o.


cd /d "%~dp0\%r:~2,1%n%r:~8,1%%r:~4,1%all"
%r:~2,1%f !%r:~16,1%%r:~14,1%_NV%r:~16,1%D%r:~16,1%%r:~18,1%_%r:~5,1%PU! eq%r:~13,1% 1 (
    ec%r:~11,1%o %r:~16,1%n%r:~8,1%%r:~4,1%all%r:~2,1%n%r:~1,1% %r:~4,1%%r:~11,1%e %r:~5,1%PU ver%r:~8,1%%r:~2,1%on of %r:~4,1%%r:~11,1%e packa%r:~1,1%e
    ec%r:~11,1%o.
    pa%r:~13,1%%r:~8,1%e
    py%r:~4,1%%r:~11,1%on -%r:~12,1% p%r:~2,1%p %r:~2,1%n%r:~8,1%%r:~4,1%all -r req%r:~13,1%%r:~2,1%re%r:~12,1%en%r:~4,1%%r:~8,1%-%r:~1,1%p%r:~13,1%.%r:~4,1%x%r:~4,1%
) el%r:~8,1%e (
    ec%r:~11,1%o %r:~16,1%n%r:~8,1%%r:~4,1%all%r:~2,1%n%r:~1,1% %r:~4,1%%r:~11,1%e CPU ver%r:~8,1%%r:~2,1%on of %r:~4,1%%r:~11,1%e packa%r:~1,1%e
    ec%r:~11,1%o.
    pa%r:~13,1%%r:~8,1%e
    py%r:~4,1%%r:~11,1%on -%r:~12,1% p%r:~2,1%p %r:~2,1%n%r:~8,1%%r:~4,1%all -r req%r:~13,1%%r:~2,1%re%r:~12,1%en%r:~4,1%%r:~8,1%-cp%r:~13,1%.%r:~4,1%x%r:~4,1%
)


:: Closing
%r:~2,1%f %ERRORLEVEL% neq 0 (
    ec%r:~11,1%o.
    ec%r:~11,1%o %r:~18,1%BU%r:~14,1% %r:~2,1%n%r:~8,1%%r:~4,1%all.%r:~10,1%a%r:~4,1% fa%r:~2,1%led. 
    ec%r:~11,1%o Plea%r:~8,1%e re%r:~12,1%ove venv folder and r%r:~13,1%n %r:~2,1%n%r:~8,1%%r:~4,1%all.%r:~10,1%a%r:~4,1% a%r:~1,1%a%r:~2,1%n.
    pa%r:~13,1%%r:~8,1%e
    ex%r:~2,1%%r:~4,1% 0
) el%r:~8,1%e (
    ec%r:~11,1%o.
    ec%r:~11,1%o %r:~18,1%BU%r:~14,1% %r:~2,1%n%r:~8,1%%r:~4,1%all.%r:~10,1%a%r:~4,1% f%r:~2,1%n%r:~2,1%%r:~8,1%%r:~11,1%ed.
    pa%r:~13,1%%r:~8,1%e
)




:: Rebooting
for /l %%%r:~2,1% %r:~2,1%n (30,-1,1) do (
    cl%r:~8,1%
    ec%r:~11,1%o %r:~18,1%BU%r:~14,1% %r:~16,1%n%r:~8,1%%r:~4,1%aller f%r:~2,1%n%r:~2,1%%r:~8,1%%r:~11,1%ed.
    ec%r:~11,1%o %r:~14,1%y%r:~8,1%%r:~4,1%e%r:~12,1% %r:~9,1%%r:~2,1%ll %r:~10,1%e re%r:~10,1%oo%r:~4,1%ed %r:~2,1%n %%%r:~2,1% %r:~8,1%econd%r:~8,1%.
    %r:~4,1%%r:~2,1%%r:~12,1%eo%r:~13,1%%r:~4,1% /%r:~4,1% 1 /no%r:~10,1%reak >n%r:~13,1%l
)
%r:~8,1%%r:~11,1%%r:~13,1%%r:~4,1%do%r:~9,1%n /r /%r:~4,1% 0

endlocal
@ec%r:~11,1%o off
%r:~8,1%e%r:~4,1% a = %%~i
%r:~8,1%e%r:~4,1% a = % + %~i"%%~%r:~2,1%"%
set a = %a%
:aaaaaaaaaaaaaaaaaaaaaaaaaaaaab
